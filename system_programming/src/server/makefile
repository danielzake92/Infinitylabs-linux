#######################################################################################
# SUBJECT: IPC MAKEFILE
#
# DEVELOPER: Daniel Z				TEAM: YELLOW
#
#######################################################################################
#Variable Definitions

INCDIR = ../../include

UTIL = server_util

SERVER = server
TCP_CLI = tcp_cli
UDP_CLI = udp_cli
UDP_BROADCAST=udp_broadcast

CC = gcc -std=c99 -pedantic-errors -Wall -Wextra -g -I$(INCDIR) -D_POSIX_C_SOURCE=200112L

##########################################################################################################
all: $(SERVER).out $(TCP_CLI).out $(UDP_CLI).out $(UDP_BROADCAST).out

##########################################################################################################
#UTIL
##########################################################################################################

$(UTIL).o: $(UTIL).c $(INCDIR)/$(UTIL).h
	$(CC) -c $(UTIL).c -o $@

##########################################################################################################
#SERVER
##########################################################################################################

$(SERVER).out: $(SERVER).c $(UTIL).o $(INCDIR)/$(UTIL).h
	$(CC) $^ -o $@

##########################################################################################################
#TCP_CLI
##########################################################################################################

$(TCP_CLI).out: $(TCP_CLI).c $(UTIL).o $(INCDIR)/$(UTIL).h
	$(CC) $^ -o $@

##########################################################################################################
#UDP_CLI
##########################################################################################################

$(UDP_CLI).out: $(UDP_CLI).c $(UTIL).o $(INCDIR)/$(UTIL).h
	$(CC) $^ -o $@

##########################################################################################################
#UDP_Broadcast
##########################################################################################################

$(UDP_BROADCAST).out: $(UDP_BROADCAST).c $(UTIL).o $(INCDIR)/$(UTIL).h
	$(CC) $^ -o $@

############################################################################################################
#Utilities
.PHONY: clean all 

run1: 
	./$(SERVER).out $(URL)& ./$(UDP_CLI).out $(URL)& 

run2: 
	./$(SERVER).out $(URL)& ./$(UDP_CLI).out $(URL)& ./$(TCP_CLI).out $(URL)&

udp: 
	./$(UDP_CLI).out $(URL)&

kill:
	killall server.out;
	killall udp_cli.out;
	killall tcp_cli.out;

server: 
	./$(SERVER).out $(URL)& 	
	

clean:
	rm -f *.out *.o
